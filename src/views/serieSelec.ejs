<!DOCTYPE html>
<html lang="pt-br" id="html" data-bs-theme=white>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/serieSelec.css">
    <title>My Movie List</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/c147ae9e45.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
</head>
<body>
      
  <nav class="navbar navbar-expand-lg bg-body-tertiary shadow">

  <div class="container-fluid d-flex justify-content-around">

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <% try { %>
      <% usuario[0].Usuario %>
      <div class="collapse navbar-collapse">
        <a class="navbar-brand" href="/<%= usuario[0].Usuario %>" id="tituloNav" >My Movie List</a>
      </div>
      <a class="navbar-brand" href="/perfil/<%= usuario[0].Usuario %>"><%= usuario[0].Usuario %></a>
      <a class="navbar-brand" href="/filmes/<%= usuario[0].Usuario %>">Filmes</a>
      <a class="navbar-brand" href="/series/<%= usuario[0].Usuario %>">Series</a>
      <span class="material-symbols-outlined" onclick="mudarDarkMode()" id="icone">
        dark_mode
      </span>
    <% } catch (error) { %>
      <a class="navbar-brand" href="/">ERRO</a>
    <% } %>

  </div>
</nav>

<main class="container d-flex position-absolute top-50 start-50 translate-middle">

  <div>

    <div class="p-2 container d-flex" id="containerInformacoes">
        <div class="d-flex flex-column align-items-center">
  
          <img id="serieCapa" src="/img/<%= serie[0].Imagem %>" alt="">
  
        </div>
  
        <div class="container d-flex flex-column justify-content-center" id="infosDaSerie">
  
            <h1 class=""><%= serie[0].Titulo %></h1>
  
            <hr>
  
            <p class="text-justify"><%= serie[0].Sinopse %></p>
  
            <div class="d-flex flex-row">
              <% for (let i = 0; i < genero.length; i ++) { %>
                <div class="generos">
                  <%= genero[i]['genero.Nome'] %> 
                </div>
              <% } %>
            </div>
  
            <br>
  
            <div class="d-flex flex-row align-items-center" style="margin-bottom: 15px;">
              <div class="d-flex justify-content-center" style="background-color: rgb(10, 10, 10); color: rgb(255, 255, 255); width: 100px; border-radius: 999px;">
                <%= serie[0].Lancamento %>
              </div>
  
              <img src="/img/<%= serie[0].IdadeIndicativa %>.jpg" alt="idadeIndicativa" id="idadeIndicativa">
            </div>
  
            <div class="d-flex justify-content-between">
  
              <div class="d-flex justify-content-start align-items-center" id="btnsUsuario">
            
            <% if(!adicionadoSerieAssistido) { %>
              
              <button type="button" class="btn btn-outline-primary d-flex align-items-center" data-bs-toggle="modal" data-bs-target="#adicionarLista" style="background: transparent; border: none;"><i class="fa-solid fa-circle-plus fa-xl"></i></button>
              
              <% if(!adicionadoPretendoAssistir) { %>
                <form action="/addQueroAssistirSerie/<%= serie[0].IDSerie %>/<%= usuario[0].Usuario %>" method="post">
                  <button type="submit" class="btn btn-outline-primary" style="border: none;">Quero Assistir</button>
                </form>
                <% } %>
              
                <% } else { %>
                  <i class="changebtns fa-solid fa-circle-check fa-xl" style="color: red;"></i>
                <% } %>
              
              </div>
                
              <% if(usuario[0].ISAdmin == 1) { %> 
                
                <div class="" id="btnsAdmin">
                  
                  <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#addTemp" style="background: transparent; border: none;"><i class="fa-solid fa-folder-plus fa-xl"></i></button>
  
                  <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#atualizarSerie" style="background: transparent; border: none;"><i class="fa-solid fa-pen-to-square fa-xl"></i></button>
                  
                  <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#deletarSerie" style="background: transparent; border: none; color: red;"><i class="fa-solid fa-trash fa-xl"></i></button>
  
                </div>
  
              <% } %>
  
          </div>
  
          </div>
  
        </div>
            
        <br>

        <div class="d-flex flex-column gap-2 mt-2">
          <% for(let i = 0; i < temporada.length; i++) { %>
            <!-- Temporadas -->
            <div>
  
              <a class="btn btn-primary w-25" data-bs-toggle="collapse" href="#temp<%= i %>" role="button" aria-expanded="false" aria-controls="collapseExample">
                <%= temporada[i].Titulo %>
              </a>
              <% if(usuario[0].ISAdmin == 1) { %>
                
                <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#addEp<%= i %>">Adicionar Episodio</button>
                
                <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#updateTemp<%= i %>">Atualizar Temporada</button>
                
                <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#deletarTemp<%= i %>" >Excluir Temporada</button>
                
              <% } %>
                <div class="collapse" id="temp<%= i %>">
                  <div class="card card-body">
                    Eps: <br>
                    <% for (let j = 0; j < ep.length; j++) { %>
                      <% if (ep[j].IDTemporada == temporada[i].IDTemporada) { %>
                        <!-- Episodios -->
                        <p><%= ep[j].Titulo %></p>
  
                        <% if(usuario[0].ISAdmin == 1) { %>
  
                          <button class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#updateEp<%= i %><%= j %>">Atualizar Episodio</button>
                  
                          <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#deletarEp<%= i %><%= j %>" >Excluir Episodio</button>
                          
                        <% } %>
                      <% } %>
                    <% } %>
              
                  </div>
                </div>
              </div>
          <% } %>
        </div>
      </div>
    
  </main>

<!-- Modal de Sucesso -->

<div class="modal" tabindex="-1" id="sucesso">
      
  <div class="modal-dialog modal-dialog-centered modal-lg">
    
    <div class="modal-content">

      <div class="modal-header">

        <h5 class="modal-title">Serie adicionada</h5>

        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

      </div>

      <div class="modal-body">

        <p>A serie <%= serie[0].Titulo %> foi adicionada à sua lista!</p>

      </div>

    </div>

  </div>
  
</div>

<!-- Modal Atualizar Serie-->

<div class="modal" tabindex="-1" id="atualizarSerie">
  
  <div class="modal-dialog modal-dialog-centered modal-lg">
    
    <div class="modal-content">

      <div class="modal-header">

        <h5 class="modal-title">Preencha os campos!</h5>

        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

      </div>

      <div class="modal-body">

        <form action="/updateSeries/<%= serie[0].IDSerie %>/<%= usuario[0].Usuario %>" enctype="multipart/form-data" method="post">

          <label class="form-label"  for="imagemInput">Imagem de capa da Série</label>
          <input class="form-control" type="file" name="imagemInput" id="imagemInput" accept="image/" value="/img/<%= serie[0].Imagem %>">

          <label class="form-label"  for="tituloInput">Titulo da Série</label>
          <input class="form-control" type="text"  name="tituloInput" name="tituloInput" value="<%= serie[0].Titulo %>">

          <label class="form-label" for="sinopseInput" >Sinopse da Série</label>
          <textarea class="form-control" name="sinopseInput" id="sinopseInput" rows="2"><%= serie[0].Sinopse %></textarea>

          <label class="form-label" for="lancamentoInput">Data de Lançamento</label>
          <input class="form-control" type="date" name="lancamentoInput" id="lancamentoInput" value="<%= serie[0].Lancamento %>">

          <label class="form-label" for="idadeIndicativaInput">Idade Indicativa</label>
          <select class="form-control" name="idadeIndicativaInput" id="idadeIndicativaInput" required>

            <option value="AL"  <%= ("AL"  === serie[0].IdadeIndicativa) ? "selected" : "" %>>AL</option>
            <option value="A10" <%= ("A10" === serie[0].IdadeIndicativa) ? "selected" : "" %>>A10</option>
            <option value="A12" <%= ("A12" === serie[0].IdadeIndicativa) ? "selected" : "" %>>A12</option>
            <option value="A14" <%= ("A14" === serie[0].IdadeIndicativa) ? "selected" : "" %>>A14</option>
            <option value="A16" <%= ("A16" === serie[0].IdadeIndicativa) ? "selected" : "" %>>A16</option>
            <option value="A18" <%= ("A18" === serie[0].IdadeIndicativa) ? "selected" : "" %>>A18</option>

          </select>

          <br>

          <div id="btnDiv">
            <button type="submit" id="btnCadSerie" class="btn btn-primary">Atualizar</button>
          </div>

        </form>

      </div>
    </div>
  </div>
</div>

<!-- Modal de add lista -->
     
<div class="modal" tabindex="-1" id="adicionarLista">
      
  <div class="modal-dialog modal-dialog-centered modal-lg">
    
    <div class="modal-content">

      <div class="modal-header">

        <h5 class="modal-title">Preencha os campos!</h5>

        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

      </div>

      <div class="modal-body">

        <form action="/serieSelec/<%= serie[0].IDSerie %>/<%= usuario[0].Usuario %>" method="post">
          
          <label for="comentarioInput">Comentário</label>

          <br>

          <textarea class="form-control" name="comentarioInput" id="comentarioInput" rows="2"></textarea>

          <br>

          <div class="estrelas">

            <input type="radio" id="cm_star-empty" name="notaInput" value="" checked/>
            <label for="cm_star-1"><i class="fa fa-star"></i></label>
            <input type="radio" id="cm_star-1" name="notaInput" value="1"/>
            <label for="cm_star-2"><i class="fa fa-star"></i></label>
            <input type="radio" id="cm_star-2" name="notaInput" value="2"/>
            <label for="cm_star-3"><i class="fa fa-star"></i></label>
            <input type="radio" id="cm_star-3" name="notaInput" value="3"/>
            <label for="cm_star-4"><i class="fa fa-star"></i></label>
            <input type="radio" id="cm_star-4" name="notaInput" value="4"/>
            <label for="cm_star-5"><i class="fa fa-star"></i></label>
            <input type="radio" id="cm_star-5" name="notaInput" value="5"/>

          </div>

          <br>

          <button type="submit" class="btn btn-primary" id="Atualizar" data-bs-dismiss="modal">Adicionar</button>

        </form>

      </div>

    </div>

  </div>
  
</div>

<!-- Modal Adicionar Temporada-->

<div class="modal" tabindex="-1" id="addTemp">
  
  <div class="modal-dialog modal-dialog-centered modal-lg">
    
    <div class="modal-content">

      <div class="modal-header">

        <h5 class="modal-title">Preencha os campos!</h5>

        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

      </div>

      <div class="modal-body">

        <form action="/addTemp/<%= serie[0].IDSerie %>/<%= usuario[0].Usuario %>" enctype="multipart/form-data" method="post">

          <label class="form-label"  for="imagemInput">Imagem de capa da Temporada</label>
          <input class="form-control" type="file" name="imagemInput" id="imagemInput" accept="image/">

          <label class="form-label"  for="tituloInput">Titulo da Temporada</label>
          <input class="form-control" type="text"  name="tituloInput" name="tituloInput">

          <label class="form-label" for="sinopseInput" >Sinopse da Temporada</label>
          <textarea class="form-control" name="sinopseInput" id="sinopseInput" rows="2"></textarea>

          <label class="form-label" for="lancamentoInput">Data de Lançamento</label>
          <input class="form-control" type="date" name="lancamentoInput" id="lancamentoInput">

          <br>

          <div id="btnDiv">
            <button type="submit" id="btnCadSerie" class="btn btn-primary">Adicionar</button>
          </div>

        </form>

      </div>
    </div>
  </div>
</div>

<!-- Modal Excluir Serie -->

<div class="modal" tabindex="-1" id="deletarSerie">

  <div class="modal-dialog modal-dialog-centered modal-sm">
    
    <div class="modal-content">

      <div class="modal-header d-flex">

        <h5 class="modal-title">Excluir Serie</h5>

        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

      </div>

      <div class="modal-body">

        <h5>Você está excluindo o serie <%= serie[0].Titulo %></h5>

        <br>

        <p>Você confirma a exclusão?</p>

        <div class="d-flex justify-content-between">

          <form action="/deletarSerie/<%= serie[0].IDSerie %>/<%= usuario[0].Usuario %>" method="post">
            <button type="submit" class="btn btn-danger m-3">Confirmar</button>
          </form>

          <button type="button" class="btn btn-secondary m-3" data-bs-dismiss="modal" aria-label="Close">Cancelar</button>
        </div>

      </div>

    </div>

  </div>

</div>

<% for(let i = 0; i < temporada.length; i++) { %>

  <!-- Modal Adicionar Episodio -->

  <div class="modal" tabindex="-1" id="addEp<%= i %>">
    
    <div class="modal-dialog modal-dialog-centered modal-lg">
      
      <div class="modal-content">

        <div class="modal-header">

          <h5 class="modal-title">Preencha os campos!</h5>

          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

        </div>

        <div class="modal-body">

          <form action="/addEp/<%= temporada[i].IDTemporada %>/<%= usuario[0].Usuario %>" enctype="multipart/form-data" method="post">

            <label class="form-label"  for="imagemInput">Imagem de capa do Episodio</label>
            <input class="form-control" type="file" name="imagemInput" id="imagemInput" accept="image/">

            <label class="form-label"  for="tituloInput">Titulo do Episodio</label>
            <input class="form-control" type="text"  name="tituloInput" name="tituloInput">

            <label class="form-label" for="sinopseInput" >Sinopse do Episodio</label>
            <textarea class="form-control" name="sinopseInput" id="sinopseInput" rows="2"></textarea>

            <label class="form-label" for="lancamentoInput">Data de Lançamento</label>
            <input class="form-control" type="date" name="lancamentoInput" id="lancamentoInput">

            <br>

            <div id="btnDiv">
              <button type="submit" id="btnCadSerie" class="btn btn-primary">Adicionar</button>
            </div>

          </form>

        </div>
      </div>
    </div>
  </div>

  <!-- Modal Atualizar Temporada -->

  <div class="modal" tabindex="-1" id="updateTemp<%= i %>">
    
    <div class="modal-dialog modal-dialog-centered modal-lg">
      
      <div class="modal-content">

        <div class="modal-header">

          <h5 class="modal-title">Preencha os campos!</h5>

          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

        </div>

        <div class="modal-body">

          <form action="/updateTemp/<%= temporada[0].IDTemporada %>/<%= usuario[0].Usuario %>" enctype="multipart/form-data" method="post">

            <label class="form-label"  for="imagemInput">Imagem de capa da Temporada</label>
            <input class="form-control" type="file" name="imagemInput" id="imagemInput" accept="image/" value="<%= temporada[i].IDTemporada %>">

            <label class="form-label"  for="tituloInput">Titulo da Temporada</label>
            <input class="form-control" type="text"  name="tituloInput" name="tituloInput" value="<%= temporada[i].Titulo %>">

            <label class="form-label" for="sinopseInput" >Sinopse da Temporada</label>
            <textarea class="form-control" name="sinopseInput" id="sinopseInput" rows="2"><%= temporada[i].Sinopse %></textarea>

            <label class="form-label" for="lancamentoInput">Data de Lançamento</label>
            <input class="form-control" type="date" name="lancamentoInput" id="lancamentoInput" value="<%= temporada[i].Lancamento %>">

            <br>

            <div id="btnDiv">
              <button type="submit" id="btnCadSerie" class="btn btn-primary">Atualizar</button>
            </div>

          </form>

        </div>
      </div>
    </div>
  </div>

  <!-- Modal Excluir Temporada -->

  <div class="modal" tabindex="-1" id="deletarTemp<%= i %>">
    
    <div class="modal-dialog modal-dialog-centered modal-sm">
      
      <div class="modal-content">

        <div class="modal-header d-flex">

          <h5 class="modal-title">Excluir Temp</h5>

          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

        </div>

        <div class="modal-body">

          <h5>Você está excluindo o temp <%= temporada[i].Titulo %></h5>

          <br>

          <p>Você confirma a exclusão?</p>

          <div class="d-flex justify-content-between">

            <form action="/deletarTemp/<%= temporada[i].IDTemporada %>/<%= usuario[0].Usuario %>" method="post">
              <button type="submit" class="btn btn-danger m-3">Confirmar</button>
            </form>

            <button type="button" class="btn btn-secondary m-3" data-bs-dismiss="modal" aria-label="Close">Cancelar</button>
          </div>

        </div>

      </div>

    </div>
    
  </div>

  <% for (let j = 0; j < ep.length; j++) { %>
    <% if (ep[j].IDTemporada == temporada[i].IDTemporada) { %>

      <!-- Modal atualizar Episodio -->
      <div class="modal" tabindex="-1" id="updateEp<%= i %><%= j %>">
  
        <div class="modal-dialog modal-dialog-centered modal-lg">
          
          <div class="modal-content">
  
            <div class="modal-header">
  
              <h5 class="modal-title">Preencha os campos!</h5>
  
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
  
            </div>
  
            <div class="modal-body">
  
              <form action="/updateEp/<%= ep[j].IDEp %>/<%= usuario[0].Usuario %>" enctype="multipart/form-data" method="post">
  
                <label class="form-label"  for="imagemInput">Imagem de capa do Episodio</label>
                <input class="form-control" type="file" name="imagemInput" id="imagemInput" accept="image/" value="<%= ep[j].Imagem %>">
  
                <label class="form-label"  for="tituloInput">Titulo do Episodio</label>
                <input class="form-control" type="text"  name="tituloInput" name="tituloInput" value="<%= ep[j].Titulo %>">
    
                <label class="form-label" for="sinopseInput" >Sinopse do Episodio</label>
                <textarea class="form-control" name="sinopseInput" id="sinopseInput" rows="2"><%= ep[j].Sinopse %></textarea>
  
                <label class="form-label" for="lancamentoInput">Data de Lançamento</label>
                <input class="form-control" type="date" name="lancamentoInput" id="lancamentoInput" value="<%= ep[j].Lancamento %>">
  
                <br>
  
                <div id="btnDiv">
                  <button type="submit" id="btnCadSerie" class="btn btn-primary">Atualizar</button>
                </div>
  
              </form>
  
            </div>
          </div>
        </div>
      </div>

      <!-- Modal Excluir Episodio -->

      <div class="modal" tabindex="-1" id="deletarEp<%= i %><%= j %>">
        
        <div class="modal-dialog modal-dialog-centered modal-sm">
          
          <div class="modal-content">

            <div class="modal-header d-flex">

              <h5 class="modal-title">Excluir Episodio</h5>

              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>

            </div>

            <div class="modal-body">

              <h5>Você está excluindo o episodio <%= ep[j].Titulo %></h5>

              <br>

              <p>Você confirma a exclusão?</p>

              <div class="d-flex justify-content-between">

                <form action="/deletarEp/<%= ep[j].IDEp %>/<%= usuario[0].Usuario %>" method="post">
                  <button type="submit" class="btn btn-danger m-3">Confirmar</button>
                </form>

                <button type="button" class="btn btn-secondary m-3" data-bs-dismiss="modal" aria-label="Close">Cancelar</button>
              </div>

            </div>

          </div>

        </div>
        
      </div>

    <% } %>
  <% } %>
<% } %>



<button type="button" class="d-none" id="abrirSucesso" data-bs-toggle="modal" data-bs-target="#sucesso"></button>

<% if(flag == 1) { %>

  <script>
    document.getElementById("abrirSucesso").click()
  </script>

<% } %>
<script src="/js/script.js"></script>
<script>
  adicionarMode();
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>